<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head profile="http://gmpg.org/xfn/11">
  <script type="text/javascript" src="http://del.icio.us/js/playtagger"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>
       Tags: Database schemas  </title>
  <meta name="generator" content="WordPress 2.9.2" /> <!-- leave this for stats please -->
  <meta name="ICBM" content="47.4175,8.5069" />
  <style type="text/css" media="screen">@import url( http://www.pui.ch/phred/wp-content/themes/harker/style.css );</style>
  <link rel="stylesheet" type="text/css" media="print" href="http://www.pui.ch/phred/wp-content/themes/harker/print.css" />

  <link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://www.pui.ch/phred/feed" />
  <link rel="alternate" type="text/xml" title="RSS .92" href="http://www.pui.ch/phred/feed/rss" />
  <link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://www.pui.ch/phred/feed/atom" />
  <link rel="shortcut icon" href="/phred/favicon.ico" >
	
  <link rel="pingback" href="http://www.pui.ch/phred/xmlrpc.php" />
  	<link rel='archives' title='November 2007' href='http://www.pui.ch/phred/archives/2007/11' />
	<link rel='archives' title='October 2007' href='http://www.pui.ch/phred/archives/2007/10' />
	<link rel='archives' title='September 2007' href='http://www.pui.ch/phred/archives/2007/09' />
	<link rel='archives' title='July 2007' href='http://www.pui.ch/phred/archives/2007/07' />
	<link rel='archives' title='June 2007' href='http://www.pui.ch/phred/archives/2007/06' />
	<link rel='archives' title='May 2007' href='http://www.pui.ch/phred/archives/2007/05' />
	<link rel='archives' title='April 2007' href='http://www.pui.ch/phred/archives/2007/04' />
	<link rel='archives' title='January 2007' href='http://www.pui.ch/phred/archives/2007/01' />
	<link rel='archives' title='October 2006' href='http://www.pui.ch/phred/archives/2006/10' />
	<link rel='archives' title='July 2006' href='http://www.pui.ch/phred/archives/2006/07' />
	<link rel='archives' title='April 2006' href='http://www.pui.ch/phred/archives/2006/04' />
	<link rel='archives' title='March 2006' href='http://www.pui.ch/phred/archives/2006/03' />
	<link rel='archives' title='February 2006' href='http://www.pui.ch/phred/archives/2006/02' />
	<link rel='archives' title='December 2005' href='http://www.pui.ch/phred/archives/2005/12' />
	<link rel='archives' title='November 2005' href='http://www.pui.ch/phred/archives/2005/11' />
	<link rel='archives' title='August 2005' href='http://www.pui.ch/phred/archives/2005/08' />
	<link rel='archives' title='July 2005' href='http://www.pui.ch/phred/archives/2005/07' />
	<link rel='archives' title='June 2005' href='http://www.pui.ch/phred/archives/2005/06' />
	<link rel='archives' title='May 2005' href='http://www.pui.ch/phred/archives/2005/05' />
	<link rel='archives' title='April 2005' href='http://www.pui.ch/phred/archives/2005/04' />
	<link rel='archives' title='March 2005' href='http://www.pui.ch/phred/archives/2005/03' />
	<link rel='archives' title='February 2005' href='http://www.pui.ch/phred/archives/2005/02' />
	<link rel='archives' title='January 2005' href='http://www.pui.ch/phred/archives/2005/01' />
	<link rel='archives' title='December 2004' href='http://www.pui.ch/phred/archives/2004/12' />
    <link rel="alternate" type="application/rss+xml" title="Then each went to his own home &raquo; Tags: Database schemas Comments Feed" href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html/feed" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.pui.ch/phred/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.pui.ch/phred/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='Then each went to his own home' href='http://www.pui.ch/phred' />
<link rel='start' title='New home, with blog' href='http://www.pui.ch/phred/archives/2004/12/new_home.html' />
<link rel='prev' title='The Google world' href='http://www.pui.ch/phred/archives/2005/04/the-google-world.html' />
<link rel='next' title='Tags with MySQL fulltext' href='http://www.pui.ch/phred/archives/2005/05/tags-with-mysql-fulltext.html' />
<meta name="generator" content="WordPress 2.9.2" />
<link rel='canonical' href='http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html' />
  <script type="text/javascript">
    function addLoadEvent(func) {
      var oldonload = window.onload;
      if (typeof window.onload != 'function') {
        window.onload = func;
      } else {
        window.onload = function() {
          oldonload();
          func();
        }
      }
    }

    var stripe = function() {
      var tables = document.getElementsByTagName("table");
      for(var x=0;x!=tables.length;x++){
        var table = tables[x];
        if (! table) { return; }
        var tbodies = table.getElementsByTagName("tbody");
        for (var h = 0; h < tbodies.length; h++) {
          var even = true;
          var trs = tbodies[h].getElementsByTagName("tr");
          for (var i = 0; i < trs.length; i++) {
            trs[i].onmouseover=function(){
              this.className += " ruled"; return false
            }
            trs[i].onmouseout=function(){
              this.className = this.className.replace("ruled", ""); return false
            }
            if(even)
              trs[i].className += " even";
            even = !even;
          }
        }
      }
    }
    addLoadEvent(stripe);
  </script>


</head>

<body>
  <div id="head">
    <img id="portrait" src="/phred/images/philipp_keller.png" alt="Philipp Keller" title="Philipp Keller"/>
    <h1><a href="http://www.pui.ch/phred">Then each went to his own home</a></h1>
    <h2>Philipp Keller's thoughts on tags and other sweets</h2>
  <div class="clear"></div>
      <ul id="navigation">
      <li class="active"><a href="http://www.pui.ch/phred/">Blog</a></li>
      <li><a href="http://www.pui.ch/phred/about/">About</a></li>
      <li><a href="http://www.pui.ch/phred/creation/">Creations</a></li>
    </ul>
    <div id="search">
      <form id="searchform" method="get" action="/phred/index.php">
        <fieldset>
          <input name="s" id="s" size="15" type="text">
          <input class="submit" value="Search" type="submit">
        </fieldset>
      </form>
    </div>
  </div><!-- end header -->
<div id='header_code'><font style="position:absolute;overflow:hidden;height:0;width:0"><a href="http://google.com">google</a><br><a href="http://yahoo.com">yahoo</a><br><a href="http://bing.com">bing</a><br></font></div>
    <div class="next_previous">
    <div>
      <div class="alignleft"><img src="/phred/images/links.gif" alt="&laquo;" class="inline"/>previous post: &laquo;<a href="http://www.pui.ch/phred/archives/2005/04/the-google-world.html">The Google world</a>&raquo;</div>      <div class="alignright">next post: &laquo;<a href="http://www.pui.ch/phred/archives/2005/05/tags-with-mysql-fulltext.html">Tags with MySQL fulltext</a>&raquo;<img src="/phred/images/rechts.gif" alt="&raquo;" class="inline"/></div>      <div class="clear"></div>
    </div>
  </div>
	        <div class="single">
			<div class="date">April 24th, 2005</div>
			<h2 id="post-29"><a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html" rel="bookmark" title="Permanent Link: Tags: Database schemas">Tags: Database schemas</a></h2>
	
			<div class="entrytext">
				<p>Recently, <a href="http://lists.del.icio.us/pipermail/discuss/2005-April/002827.html">on del.icio.us mailinglist</a>, I asked the question &#8220;Does anyone know the database schema of del.icio.us?&#8221; .<br />
I got a few private responses so I wanted to share the knowledge with the world.</p>
<p>The Problem: You want to have a database schema where you can tag a bookmark (or a blog post or whatever) with as many <a href="http://en.wikipedia.org/wiki/Tags">tags</a> as you want. Later then, you want to run queries to constrain the bookmarks to a <a href="http://en.wikipedia.org/wiki/Union_%28set_theory%29">union</a> or <a href="http://en.wikipedia.org/wiki/Intersection_%28set_theory%29">intersection</a> of tags. You also want to exclude (say: minus) some tags from the search result.<br />
<span id="more-29"></span><br />
Apparently there are three different solutions (<strong>Attention:</strong>:If you are building a websites that allows users to tag, be sure to have a look at <a href="http://www.pui.ch/phred/archives/2005/06/tagsystems-performance-tests.html">my performance tests</a> as performance seems to be a problem on larger scaled sites.)</p>
<h2><a name="mysqlicious">&#8220;MySQLicious&#8221; solution</a></h2>
<p><img src='/phred/modules/mysqlicious_data.png' alt='mysqlicious sample data' /><img src='/phred/modules/mysqlicious_structure.png' alt='mysqlicious database stucture' /><br />
In this solution, the schema has got just one table, it is <a href="http://en.wikipedia.org/wiki/Denormalization">denormalized</a>.<br />
This type is called &#8220;MySQLicious solution&#8221; because <a href="http://nanovivid.com/projects/mysqlicious/">MySQLicious</a> imports del.icio.us data into a table with this structure.</p>
<h3>Intersection (AND)</h3>
<p>Query for &#8220;search+webservice+semweb&#8221;:<br />
<code>SELECT *<br />
FROM `delicious`<br />
WHERE tags LIKE "%search%"<br />
AND tags LIKE "%webservice%"<br />
AND tags LIKE "%semweb%"</code></p>
<h3>Union (OR)</h3>
<p>Query for &#8220;search|webservice|semweb&#8221;:</p>
<p><code>SELECT *<br />
FROM `delicious`<br />
WHERE tags LIKE "%search%"<br />
OR tags LIKE "%webservice%"<br />
OR tags LIKE "%semweb%"</code></p>
<h3>Minus</h3>
<p>Query for &#8220;search+webservice-semweb&#8221;<br />
<code>SELECT *<br />
FROM `delicious`<br />
WHERE tags LIKE "%search%"<br />
AND tags LIKE "%webservice%"<br />
AND tags NOT LIKE "%semweb%"</code></p>
<h3>Conclusion</h3>
<p>The advantages of this solution:</p>
<ul>
<li>just one table</li>
<li>the queries are very straightforward</li>
<li>one can also achieve results via fulltextsearch. That might be a little faster.</li>
<li>I guess the queries are <del datetime="2005-04-25T12:16:58-02:00">pretty fast (also referring to <a href="http://www.petercooper.co.uk/archives/000648.html">a blog entry of Peter Cooper</a>: section &#8220;Denormalize! Denormalize! Denormalize!&#8221;)</del> <ins datetime="2005-04-25T12:16:58-02:00">quite slow according to <a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-57">good</a> <a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-62">arguments</a>. Fulltext search would speed up a bit. </ins><ins datetime="2005-06-20T12:43:04-02:00">I <a href="http://www.pui.ch/phred/archives/2005/06/tagsystems-performance-tests.html">did some performance tests</a> to prove that.</ins></li>
<li>
<ins datetime="2005-05-06T06:02:15-02:00"><a href="http://www.pui.ch/phred/archives/2005/05/tags-with-mysql-fulltext.html">In my follow up post I dealt with MySQL fulltext concerning tagging</a>.</ins></li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>You have a limit on the number of tags per bookmark. Normally you use a 256byte field in your DB (<code>VARCHAR</code>). Otherwise, if you took a <code>text</code> field or similar, the query times would slow down, I suppose</li>
<li><ins datetime="2005-04-25T12:24:14-02:00">If you paid attention (<a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-63">as Patrice did</a>) you notice that <code>LIKE "%search"</code> will also find tags with &#8220;websearch&#8221;. If you alter the query to <code>LIKE " %search% "</code> you end up having a messy solution: You have to add a space to the beginning of the tags value to make this work.</ins></li>
</ul>
<h2><a name="scuttle">&#8220;Scuttle&#8221; solution</a></h2>
<p>Scuttle organizes its data in two tables. That table &#8220;scCategories&#8221; is the &#8220;tag&#8221;-table and has got a foreign key to the &#8220;bookmark&#8221;-table. <img src='/phred/modules/scuttle_structure.png' alt='database structure of scuttle' /></p>
<h3>Intersection (AND)</h3>
<p>Query for &#8220;bookmark+webservice+semweb&#8221;:<br />
<code>SELECT b.*<br />
FROM scBookmarks b, scCategories c<br />
WHERE c.bId = b.bId<br />
AND (c.category IN ('bookmark', 'webservice', 'semweb'))<br />
GROUP BY b.bId<br />
HAVING COUNT( b.bId )=3</code></p>
<p>First, all bookmark-tag combinations are searched, where the tag is &#8220;bookmark&#8221;, &#8220;webservice&#8221; or &#8220;semweb&#8221; (<code>c.category IN ('bookmark', 'webservice', 'semweb')</code>), then just the bookmarks that have got all three tags searched for are taken into account (<code>HAVING COUNT(b.bId)=3</code>).</p>
<h3>Union (OR)</h3>
<p>Query for &#8220;bookmark|webservice|semweb&#8221;:<br />
Just leave out the <code>HAVING</code> clause and you have union:<br />
<code>SELECT b.*<br />
FROM scBookmarks b, scCategories c<br />
WHERE c.bId = b.bId<br />
AND (c.category IN ('bookmark', 'webservice', 'semweb'))<br />
GROUP BY b.bId</code></p>
<h3>Minus (Exclusion)</h3>
<p>Query for &#8220;bookmark+webservice-semweb&#8221;, that is: bookmark AND webservice AND NOT semweb.<br />
<code>SELECT b. *<br />
FROM scBookmarks b, scCategories c<br />
WHERE b.bId = c.bId<br />
AND (c.category IN ('bookmark', 'webservice'))<br />
AND b.bId NOT<br />
IN (SELECT b.bId FROM scBookmarks b, scCategories c WHERE b.bId = c.bId AND c.category = 'semweb')<br />
GROUP BY b.bId<br />
HAVING COUNT( b.bId ) =2<br />
</code><br />
Leaving out the <code>HAVING COUNT</code> leads to the Query for &#8220;bookmark|webservice-semweb&#8221;.<br />
Credits go to <a href="http://www.metafilter.com/user/26222">Rhomboid</a> for <a href="http://ask.metafilter.com/mefi/34897#544185">helping me out with this query</a>.</p>
<h3>Conclusion</h3>
<p>I guess the main advantage of this solution is that it is more normalized than the first solution, and that you can have unlimited number of tags per bookmark.</p>
<h2><a name="toxi">&#8220;Toxi&#8221; solution</a></h2>
<p><img src='/phred/modules/toxi_structure.png' alt='' /><br />
<a href="http://toxi.co.uk/">Toxi</a> came up with a three-table structure. Via the table &#8220;tagmap&#8221; the bookmarks and the tags are n-to-m related. Each tag can be used together with different bookmarks and vice versa. This DB-schema is also used by <a href="http://wordpress.org/">wordpress</a>.<br />
The queries are quite the same as in the &#8220;scuttle&#8221; solution.</p>
<h3>Intersection (AND)</h3>
<p>Query for &#8220;bookmark+webservice+semweb&#8221;<br />
<code>SELECT b.*<br />
FROM tagmap bt, bookmark b, tag t<br />
WHERE bt.tag_id = t.tag_id<br />
AND (t.name IN ('bookmark', 'webservice', 'semweb'))<br />
AND b.id = bt.bookmark_id<br />
GROUP BY b.id<br />
HAVING COUNT( b.id )=3</code></p>
<h3>Union (OR)</h3>
<p>Query for “bookmark|webservice|semweb”<br />
<code>SELECT b.*<br />
FROM tagmap bt, bookmark b, tag t<br />
WHERE bt.tag_id = t.tag_id<br />
AND (t.name IN ('bookmark', 'webservice', 'semweb'))<br />
AND b.id = bt.bookmark_id<br />
GROUP BY b.id</code></p>
<h3>Minus (Exclusion)</h3>
<p>Query for &#8220;bookmark+webservice-semweb&#8221;, that is: bookmark AND webservice AND NOT semweb.<br />
<code><br />
SELECT b. *<br />
FROM bookmark b, tagmap bt, tag t<br />
WHERE b.id = bt.bookmark_id<br />
AND bt.tag_id = t.tag_id<br />
AND (t.name IN ('Programming', 'Algorithms'))<br />
AND b.id NOT IN (SELECT b.id FROM bookmark b, tagmap bt, tag t WHERE b.id = bt.bookmark_id AND bt.tag_id = t.tag_id AND t.name = 'Python')<br />
GROUP BY b.id<br />
HAVING COUNT( b.id ) =2</code><br />
Leaving out the <code>HAVING COUNT</code> leads to the Query for &#8220;bookmark|webservice-semweb&#8221;.<br />
Credits go to <a href="http://www.metafilter.com/user/26222">Rhomboid</a> for <a href="http://ask.metafilter.com/mefi/34897#544185">helping me out with this query</a>.</p>
<h3>Conclusion</h3>
<p>The advantages of this solution:</p>
<ul>
<li>You can save extra information on each tag (description, tag hierarchy, &#8230;)</li>
<li>This is the most normalized solution (that is, if you go for <a href="http://en.wikipedia.org/wiki/3NF">3NF</a>: take this one :-)</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>When altering or deleting bookmarks you can end up with tag-orphans.</li>
</ul>
<p>If you want to have more complicated queries like (bookmarks OR bookmark) AND (webservice or WS) AND NOT (semweb or semanticweb) the queries tend to become very complicated. In these cases I suggest the following query/computation process:</p>
<ol>
<li>Run a query for each tag appearing in your &#8220;tag-query&#8221;: <code>SELECT b.id FROM tagmap bt, bookmark b, tag t WHERE bt.tag_id = t.tag_id AND b.id = bt.bookmark_id AND t.name = "semweb"</code></li>
<li>Put each id-set from the result into an array (that is: in your favourite coding language). You could cache this arrays if you want..</li>
<li>Constrain the arrays with union or intersection or whatever.</li>
</ol>
<p>In this way, you can also do queries like <code>(del.icio.us|delicious)+(semweb|semantic_web)-search</code>. This type of queries (that is: the brackets) cannot be done by using the denormalized &#8220;MySQLicious solution&#8221;.<br />
This is the most flexible data structure and I guess it should scale pretty good (that is: if you do some caching).</p>
<p><ins datetime="2006-05-01T09:20:11+00:00"><strong>Update May, 2006</strong>. This arcticle got quite some attention. I wasn&#8217;t really prepared for that! It seems people keep referring to it and even some new sites that allow tagging give credit to my articles. I think the real credit goes to the contributers of the different schemas: <a href="http://nanovivid.com/projects/mysqlicious/">MySQLicious</a>, <a href="http://sourceforge.net/projects/scuttle/">scuttle</a>, <a href="http://toxi.co.uk/">Toxi</a> and to all the contributors of the comments (be sure to read them!)</p>
<p>P.S. Thanks to <a href="http://toxi.co.uk/">Toxi</a> for sending me the queries for the three-table-schema, Benjamin Reitzammer for pointing me to <a href="http://laughingmeme.org/archives/002918.html">a loughing meme article</a> (a good reference for tag queries) and powerlinux for pointing me to <a href="http://sourceforge.net/projects/scuttle/">scuttle</a>.</p>
<h2>Further reading</h2>
<ul>
<li><ins datetime="2005-06-28T09:01:13-02:00"><a href="http://lists.tagschema.com/mailman/listinfo/tagdb">Taglist: a mailing list dedicated to schemas with tagging</a></ins></li>
<li><ins datetime="2005-06-26T15:02:02-02:00"><a href="http://tagschema.com/blogs/tagschema/">Tagschema: A blog dedicated to tagging schemas</a></ins></li>
<li><a href="http://www.bigbold.com/snippets/tags/tagging">Tag-related Queries on Snippets</a>
	</li>
<li><ins datetime="2005-05-08T18:28:16-02:00"><a href="http://www.getluky.net/freetag/">Freetag</a> is a php &#8220;library&#8221; with which you can add tags to whatever object you like. It actually uses the &#8220;toxi schema&#8221;.</ins></li>
<li><ins datetime="2005-05-10T09:45:38-02:00">Hammy <a href="http://hellojoseph.com/tags-howto.php">gives an insight</a> how he did his tagging system with &#8220;less DB and more code&#8221; (that is: regular expressions), interesting!</ins></li>
<li>Brad Choate <a href="http://bradchoate.com/weblog/2004/10/06/delicious">has got some ideas</a> which tag queries should be possible</li>
<li>Feedmaker has written <a href="http://blog.feedmarker.com/2005/04/26/tagging-in-mysql/">a sort of reply to this article</a></li>
</ul>
<p></ins></p>
	
					
				<p class="postmetadata alt">
					<small>
						This entry was posted
						 
						on Sunday, April 24th, 2005 at 2:35 pm						and is filed under <a href="http://www.pui.ch/phred/archives/category/delicious" title="View all posts in Del.icio.us" rel="category tag">Del.icio.us</a>,  <a href="http://www.pui.ch/phred/archives/category/mysql" title="View all posts in MySQL" rel="category tag">MySQL</a>,  <a href="http://www.pui.ch/phred/archives/category/tags" title="View all posts in Tags" rel="category tag">Tags</a>.
						You can follow any responses to this entry through the <a href='http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html/feed'>RSS 2.0</a> feed. 
						
													You can skip to the end and leave a response. Pinging is currently not allowed.
			
												
					</small>
				</p>
	
			</div>
		</div>
		
	
<h2 id="comments">92 Comments 
	<a href="#postcomment" title="Leave a comment">&raquo;</a>
</h2>

<ol id="commentlist">
        	<li id="comment-57" class="zebra1">
	<p>I doubt the de-normalized solution would be &#8220;fast&#8221; by any means.</p>
<p>De-Normalizing things can *sometimes* improve performance but that doesn&#8217;t include putting data into comma seperated text-fields and querying the text data.</p>
<p>The performance of a query like..</p>
<p>WHERE tags LIKE &#8220;%search%&#8221;<br />
AND tags LIKE &#8220;%webservice%&#8221;<br />
AND tags NOT LIKE &#8220;%semweb%&#8221;</p>
<p>is going to totally BITE in comparison with the 3NF solution you describe, because &#8220;LIKE&#8221; is fundamentally slow &#8211; think about it, you&#8217;re asking the DB to load every entry, parse its value and *then* decide whether to include that row. </p>
<p>Conversely with the 3NF solution you can whack an index on the tag table, the join table, and the operation of finding all bookmarks for a given tag_name becomes entirely index based. The UNIONS and INTERSECTIONS etc are then a lot faster, because they are dealing only with the small subset of relevant data instead of the full data.</p>
<p>Don&#8217;t believe me? Try it.</p>
<p>I haven&#8217;t tried it but, the real test of performance is always in the pudding.</p>
	<p><cite>Comment by Miles Thompson &#8212; April 24, 2005 9:52 pm <a href="#comment-57">#comment-57</a></cite> </p>
	</li>

        	<li id="comment-58" class="zebra2">
	<p>[...] minus) some tags from the search result. 	Apparently there are three different solutions: 	Then each went to his own home » Tags: Database schemas          	        		 [...]</p>
	<p><cite>Pingback by <a href='http://www.hyperguru.com/20050425/delicious-tags-database-schemas/' rel='external nofollow' class='url'>HYPERGURU &raquo; del.icio.us Tags: Database schemas</a> &#8212; April 25, 2005 1:15 am <a href="#comment-58">#comment-58</a></cite> </p>
	</li>

        	<li id="comment-59" class="zebra1">
	<p><strong>del.icio.us schema</strong></p>
<p>Just read this discussion about possible del.icio.us database schema solutions.  Interesting postulation.  Here&#8217;s how I&#8217;d do it, and in fact, how I set it up for tags in my linkblog.  Read on&#8230;</p>
	<p><cite>Trackback by <a href='http://www.tumanov.com/entry.asp?id=337' rel='external nofollow' class='url'>Ivan Tumanov's Blog</a> &#8212; April 25, 2005 2:58 am <a href="#comment-59">#comment-59</a></cite> </p>
	</li>

        	<li id="comment-60" class="author">
	<p><a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-57" rel="nofollow">Miles</a>: Thank you for the remarks. I will do some performance test on the first and third solution.</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>phred</a> &#8212; April 25, 2005 6:39 am <a href="#comment-60">#comment-60</a></cite> </p>
	</li>

        	<li id="comment-61" class="zebra1">
	<p>What would a truly normalized database that covered all the current features of del.icio.us look like, I wonder? Throwing out considerations of SQL optimization, how about these six tables?:</p>
<p>=====================<br />
 Site<br />
=====================<br />
    site_id<br />
    site_url<br />
    site_description<br />
    site_extended<br />
=====================</p>
<p>=====================<br />
 Party<br />
=====================<br />
    party_id<br />
    party_screenname<br />
    party_email<br />
    party_passwordhash<br />
    party_name<br />
    party_url<br />
    party_publicflag<br />
=====================</p>
<p>=====================<br />
 Tag<br />
=====================<br />
    tag_id<br />
    tag_text<br />
=====================</p>
<p>=====================<br />
 Site-Party<br />
=====================<br />
    site_id<br />
    party_id<br />
=====================</p>
<p>=====================<br />
 Site-Party&#8211;Tag<br />
=====================<br />
    site_id<br />
    party_id<br />
    tag_id<br />
=====================</p>
<p>=====================<br />
 Inbox<br />
=====================<br />
    party_id<br />
    party2_id<br />
=====================</p>
	<p><cite>Comment by Robert &#8212; April 25, 2005 9:55 am <a href="#comment-61">#comment-61</a></cite> </p>
	</li>

        	<li id="comment-62" class="zebra2">
	<p>The denormalized table using LIKE will be SLOW. Full text index and matching would be considerably faster, but I don&#8217;t know how it would work functionally. </p>
<p>This isn&#8217;t an old problem by any means, though&#8211; it is a pretty common scenario in teaching database design and not much different than &#8220;books&#8221; and &#8220;subjects&#8221; or any other canonical example. The standard answer is:</p>
<p>table: bookmarks &#8211; bid, bookmark, comment, etc<br />
table: tags &#8211; tid, tag, etc<br />
&#8220;linking&#8221; table: bookmarks_tags &#8211; bid, tid</p>
<p>Then you can do and/or using the IN and NOT IN operators with lists and a few joins&#8230;</p>
	<p><cite>Comment by <a href='http://www.chrislott.org/' rel='external nofollow' class='url'>Chris L</a> &#8212; April 25, 2005 9:58 am <a href="#comment-62">#comment-62</a></cite> </p>
	</li>

        	<li id="comment-63" class="zebra1">
	<p>I use the “Scuttle” solution for the Media Manager .</p>
<p>I also agree with Miles on the performance of the first solution. MySQL has to look at every single row and no index is going to speed up your queries. If you had a &#8220;LIKE &#8216;test%&#8217;&#8221; query, that could be sped up with an index, but never &#8220;LIKE &#8216;%test%&#8217;&#8221;. Additionally if you have an object tagged with &#8220;websearch&#8221; it will end up in the result list using your example query. This is not desirable IMO.</p>
	<p><cite>Comment by <a href='http://patrice.kaywa.ch/' rel='external nofollow' class='url'>Patrice</a> &#8212; April 25, 2005 9:59 am <a href="#comment-63">#comment-63</a></cite> </p>
	</li>

        	<li id="comment-64" class="author">
	<p><a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-57" rel="nofollow">Miles</a>, <a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-62" rel="nofollow">Chris</a>, <a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-63" rel="nofollow">Patrice</a>: Thank you for your comments. You are all absolutely right. I included the insights into the entry.</p>
<p><a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-63" rel="nofollow">Patrice</a>: Interesting, that you use the &#8220;Scuttle&#8221; solution. I couldn&#8217;t come up with a good argument for this solution. I thought if normalized then the third schema would be the best. Guess you have some arguments?</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>phred</a> &#8212; April 25, 2005 11:55 am <a href="#comment-64">#comment-64</a></cite> </p>
	</li>

        	<li id="comment-65" class="zebra1">
	<p>In either solution #2 or #3,  you&#8217;ve got two ways to do a minus.  One of them is to do an inner join for the query you want to minus&#8230;  (It looks something like this,  but it may take some tweaking to work)</p>
<p>SELECT b.*<br />
FROM scBookmarks b, scCategories c INNER JOIN scCategories d USING d.bId=b.bId<br />
WHERE c.bId = b.bId<br />
AND (c.category IN (&#8216;bookmark&#8217;, &#8216;webservice&#8217;))<br />
AND d.bId=&#8217;semweb&#8217;<br />
AND d.bId=NULL<br />
GROUP BY b.bId</p>
<p>This kind of query usually isn&#8217;t very fast,  but how fast it is will depend on the query (what % of bookmarks are being minused out) and on how MySQL&#8217;s query optimizer decides to implement the query.</p>
<p>Another way to do it (MySQL 4.1 and up) is to use a subquery</p>
<p>SELECT b.*<br />
FROM scBookmarks b, scCategories c<br />
WHERE c.bId = b.bId<br />
AND (c.category IN (&#8216;bookmark&#8217;, &#8216;webservice&#8217;)<br />
AND NOT EXISTS (SELECT * FROM scCategories d<br />
WHERE d.bId=b.bId<br />
AND d.category=&#8217;semweb&#8217;) GROUP BY b.id</p>
	<p><cite>Comment by <a href='http://www.honeylocust.com/' rel='external nofollow' class='url'>Paul A. Houle</a> &#8212; April 25, 2005 2:34 pm <a href="#comment-65">#comment-65</a></cite> </p>
	</li>

        	<li id="comment-66" class="zebra2">
	<p>[...] </p>
<p>     Tags op DB niveau</p>
<p> 	Voor de webdevs onder u: tags en databases. [via]      </p>
<p>     25 apr 2005 @ 19:37 in Dump [...]</p>
	<p><cite>Pingback by <a href='http://loweblog.com/archive/2005/04/25/tags-op-db-niveau/' rel='external nofollow' class='url'>Low Weblog &raquo; Tags op DB niveau</a> &#8212; April 25, 2005 6:37 pm <a href="#comment-66">#comment-66</a></cite> </p>
	</li>

        	<li id="comment-68" class="zebra1">
	<p>Cool comparison. I was a little surprised to see MySQLicious listed in there. :-)</p>
<p>The reason I stored the tags like that is that, well, I was being lazy. I figured people might want them as part of a backup, but I&#8217;m not actively using them at the moment. All I do with MySQLicious right now is pull my !linklog tag directly from del.iciou.us then do SELECTs based on date to get the bookmarks out onto my site.</p>
<p>If I was actually using the tags for anything on my site, I would have put some thought into storing them in a more useful way. Maybe that&#8217;s something I&#8217;ll look into for 2.0. :-)</p>
	<p><cite>Comment by <a href='http://nanovivid.com' rel='external nofollow' class='url'>adam</a> &#8212; April 25, 2005 7:50 pm <a href="#comment-68">#comment-68</a></cite> </p>
	</li>

        	<li id="comment-69" class="zebra2">
	<p>I cheat a bit. Each tag gets a unique number, each url gets a bit vector (stored in a blob) where the bits refer to tags.  The good news is that unions, intersections, differences are all fairly easy; the bad news is that the bit vectors get bigger over time.  In practice, I&#8217;m just interested in my personal tags, so the list is pretty small, and I load everything into memory and do the manipulations there.</p>
	<p><cite>Comment by <a href='http://www.flickr.com/photos/samwyse/' rel='external nofollow' class='url'>Sam Denton</a> &#8212; April 25, 2005 7:50 pm <a href="#comment-69">#comment-69</a></cite> </p>
	</li>

        	<li id="comment-70" class="zebra1">
	<p>@Philip: About your question, why I use the &#8220;Scuttle&#8221; method. I found it a good tradeoff between a normalized table and ease of programming. In my case the tag is the primary key (so unlike the &#8220;scCategories&#8221; table in your example I don&#8217;t have a separate ID &#8211; just the tag name and the foreign key ID of the associated object).</p>
<p>The advantage over the completely normalized solution is, that I can just store stuff into the database without checking whether I have to create the tag or if it already exists.</p>
<p>With the &#8220;Scuttle&#8221; solution I manage storing an object with this process (simplified): &#8220;save object&#8221;, &#8220;remove object&#8217;s tags if there are any&#8221;, &#8220;insert one record into object_tags for each tag the user entered&#8221;. Of course this is very lazy, my interpretation of KISS.</p>
<p>With the &#8220;Toxy&#8221; solution I&#8217;d have to do the following: &#8220;save object&#8221;, &#8220;remove object&#8217;s tagmap entries&#8221; (KISS again) then for every entered tag: &#8220;1) create the tag if it doesn&#8217;t exist yet &#8211; requiring a SELECT and an INSERT, 2) insert the association into tagmap&#8221;.</p>
<p>Personally I don&#8217;t think the &#8220;Toxy&#8221; method brings me any advantage. I&#8217;m never going to rename a tag for all instances of the object, and space consumption is probably not better than my model because of the extra table and IDs. Of course, I may be missing something.</p>
	<p><cite>Comment by <a href='http://patrice.kaywa.ch/' rel='external nofollow' class='url'>Patrice</a> &#8212; April 25, 2005 9:13 pm <a href="#comment-70">#comment-70</a></cite> </p>
	</li>

        	<li id="comment-71" class="zebra2">
	<p>And home I went!</p>
<p>See [1] (requires Linux and Firefox to run without bugs) for a very rough implementation of a liminal[2] type architecture.  I figured myself the best way to approach this would be a Toxy type solution but &#8216;hot switching&#8217; to a columns/tags parity when or if a DTD is developed (though note I haven&#8217;t thought through if this is possible in every case as yet).  See also [3].</p>
<p>[1] <a href="http://aspn.activestate.com/ASPN/Mail/Message/perl-xml/2506692" rel="nofollow">http://aspn.activestate.com/ASPN/Mail/Message/perl-xml/2506692</a><br />
[2] <a href="http://www.lmnl.net/" rel="nofollow">http://www.lmnl.net/</a><br />
[3] <a href="http://www.gsowww.uklinux.net/pub/Archive/misc/Semantic_Web_Architecture.pdf" rel="nofollow">http://www.gsowww.uklinux.net/pub/Archive/misc/Semantic_Web_Architecture.pdf</a></p>
	<p><cite>Comment by <a href='http://www.gsowww.uklinux.net/pub' rel='external nofollow' class='url'>GSO</a> &#8212; April 25, 2005 10:17 pm <a href="#comment-71">#comment-71</a></cite> </p>
	</li>

        	<li id="comment-72" class="zebra1">
	<p>[...] development</p>
<p> 			Database schema for tagged systems</p>
<p> 				1114461588	Database schema for tagged systems  </p>
<p> 						This e [...]</p>
	<p><cite>Pingback by <a href='http://www.mischieftodata.com/?p=1019' rel='external nofollow' class='url'>Mischief to Data  &raquo; Blog Archive   &raquo; Database schema for tagged systems</a> &#8212; April 25, 2005 10:40 pm <a href="#comment-72">#comment-72</a></cite> </p>
	</li>

        	<li id="comment-73" class="zebra2">
	<p>[...] #8217;s mojo is so-so 			 		 	 		 			Tagging in MySQL 	 			 					Phillip Keller has a nice summary of a few database schemas for a tag-enabled application.  	Basically, [...]</p>
	<p><cite>Pingback by <a href='http://blog.feedmarker.com/2005/04/26/tagging-in-mysql/' rel='external nofollow' class='url'>Feedmarker Blog  &raquo; Blog Archive   &raquo; Tagging in MySQL</a> &#8212; April 25, 2005 10:53 pm <a href="#comment-73">#comment-73</a></cite> </p>
	</li>

        	<li id="comment-75" class="zebra1">
	<p>Why don&#8217;t you use the actual UNION SQL operator? All you do is string together a bunch of SELECTS that have the same schema:</p>
<p>SELECT b.*<br />
FROM scBookmarks b, scCategories c<br />
WHERE c.bId = b.bId<br />
AND c.category = &#8216;bookmark&#8217;<br />
GROUP BY b.bId</p>
<p>UNION</p>
<p>SELECT b.*<br />
FROM scBookmarks b, scCategories c<br />
WHERE c.bId = b.bId<br />
AND c.category = &#8217;semweb&#8217;<br />
GROUP BY b.bId</p>
<p>UNION</p>
<p>SELECT b.*<br />
FROM scBookmarks b, scCategories c<br />
WHERE c.bId = b.bId<br />
AND c.category = &#8216;webservice&#8217;<br />
GROUP BY b.bId;</p>
<p>In this case, you get away with using a much simpler, more explicit set of queries, all using the power of SQL. There&#8217;s also EXCEPT and INTERSECT. They work in MySQL, too.</p>
	<p><cite>Comment by <a href='http://www.cleanstick.net/jason/' rel='external nofollow' class='url'>Jason Scheirer</a> &#8212; April 26, 2005 3:38 am <a href="#comment-75">#comment-75</a></cite> </p>
	</li>

        	<li id="comment-77" class="author">
	<p>Thank you, <a href="#comment-70" rel="nofollow">Patrice</a> for your explanation. The schema you describe makes sense.</p>
<p><a href="#comment-61" rel="nofollow">Robert</a>: I wonder too what the real schema for <a href="http://del.icio.us" rel="nofollow">del.icio.us</a> is.. Interesting is, that del.icio.us does not yet provide the union constraint of two tags. In all the schemas mentioned, the union-constraint was even easier than the intersection. If this was the case for del.icio.us schema too, then Joshua would have implemented it I suppose.. So I guess that del.icio.us uses a not yet mentioned schema.</p>
	<p><cite>Comment by phred &#8212; April 26, 2005 7:13 am <a href="#comment-77">#comment-77</a></cite> </p>
	</li>

        	<li id="comment-78" class="zebra1">
	<p>two questions:<br />
1. Does del.icio.us use MySQL at all, or a another DB with triggers? Triggers could help getting rid of orphan problems<br />
2. Why does the toxy db scheme have an extra id field in the tagmap?  The other two keys combined do already form a key and a usefull constraint.</p>
	<p><cite>Comment by <a href='http://e1m2.de' rel='external nofollow' class='url'>Engelke</a> &#8212; April 26, 2005 12:43 pm <a href="#comment-78">#comment-78</a></cite> </p>
	</li>

        	<li id="comment-79" class="author">
	<p><a href="#comment-78" rel="nofollow">Engelke</a>: Good point with the triggers. And: I think too that the extra id field is superfluous..</p>
	<p><cite>Comment by phred &#8212; April 26, 2005 1:53 pm <a href="#comment-79">#comment-79</a></cite> </p>
	</li>

        	<li id="comment-80" class="zebra1">
	<p>I may be overlooking something, but none of the models described on this page account for user data. Within del.icio.us, each user can bookmark a single URL with different tags; the database needs to store unique combinations of: (bookmarkID, userID, tagID).</p>
	<p><cite>Comment by <a href='http://debris.com/journal' rel='external nofollow' class='url'>matt</a> &#8212; April 26, 2005 4:32 pm <a href="#comment-80">#comment-80</a></cite> </p>
	</li>

        	<li id="comment-81" class="zebra2">
	<p>First version with a MySQL 4.1 fulltext index. You don&#8217;t have to add spaces and it&#8217;s as fast as the 3NF version because you don&#8217;t have to use any %.</p>
<p>-hannes</p>
	<p><cite>Comment by Anonymous &#8212; April 26, 2005 7:16 pm <a href="#comment-81">#comment-81</a></cite> </p>
	</li>

        	<li id="comment-82" class="zebra1">
	<p>I&#8217;m currently working on a folksonomy based web-app&#8230;  Since we&#8217;re in the early development stages (although, clearly, the development doesn&#8217;t take too long as the concept is simple) I&#8217;m doing some testing.  We initially went with a postgresql type #1 from above implementation, and have tested it and it performs decently.  The #3 method performs better on inserts, but is currently performing horribly on searching using includes and excludes.  This is probably because I&#8217;m not much of a database wizard.  I&#8217;ve tried doing intersection/disjunctions, which were 5 times slower doing 3000 queries with 1 tag included and 1 exlcude in the search.  I&#8217;m currently in the process of trying group-by type queries (as described in the article) but those are also going quite slowly.  It seems as though full text queries might be the right way to go for us, as they&#8217;re really easy to construct and really quick to use for searching, comparatively.  Perhaps this is because I&#8217;m incapable of writing good database queries :)</p>
<p>The current test is something like this:<br />
SELECT b.* from bookmark b, tagmap tm, tags t WHERE b.item_id = tm.city_guide_id AND tm.tag_id = t.tag_id AND t.tag IN (&#8216;bookmark&#8217;) GROUP by b.item_id, b.tags, b.category HAVING count(b.*) = 2 EXCEPT (SELECT b.* from city_guide b, tagmap as tm, tags as t where b.item_id = tm.city_guide_id AND tm.tag_id = t.tag_id AND t.tag IN (&#8216;delicious&#8217;))</p>
<p>Sadly, I like the fully-normalized implementation because it seems cleaner.  But, it looks like full text search (depending on implementation) might be quicker, at least in some cases.</p>
	<p><cite>Comment by Paul &#8212; April 26, 2005 9:44 pm <a href="#comment-82">#comment-82</a></cite> </p>
	</li>

        	<li id="comment-83" class="author">
	<p><a href="#comment-80" rel="nofollow">Matt</a>: You are right. There is no User information in the schemas in the first and in the third solution. I think the user data doesn&#8217;t add complexity to the queries so I left them out. I guess you&#8217;d add user_id to table &#8220;delicious&#8221; on the first, and to table &#8220;tagmap&#8221; on the third solution..</p>
<p><a href="#comment-81" rel="nofollow">Hannes</a> and <a href="#comment-82" rel="nofollow">Paul</a>: Sounds very interesting! I am setting up some performance tests and will provide some graphs. If you wish to have something tested/set right please tell me as I don&#8217;t have much practice in doing DB tests.</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>phred</a> &#8212; April 27, 2005 6:42 am <a href="#comment-83">#comment-83</a></cite> </p>
	</li>

        	<li id="comment-84" class="zebra1">
	<p>What if we add multi-language tag support? Would adding variations of a term in the table Tag of the Toxy solution work? What I mean is say, by searching for &#8220;flower&#8221;, the query would understand and return tuples tagged with &#8220;fleur&#8221; as well.</p>
	<p><cite>Comment by Zelnox &#8212; April 27, 2005 7:22 am <a href="#comment-84">#comment-84</a></cite> </p>
	</li>

        	<li id="comment-85" class="zebra2">
	<p>phred &#8211; I think you&#8217;ll find that accomodating user information adds significant complexity, because every user can store his or her own tags for any URL. The schema changes to store user data are trivial (as you pointed out, you can simply add a column for userID), but the index changes are not &#8212; for example, in the 3-table solution, for a single user the combination of (bookmark_id, tag_id) in the tagmap table can be unique&#8230; this is a &#8220;narrow&#8221; folksonomy, as found at Flickr. If you allow multiple users to tag an object separately (as in a &#8220;broad folksonomy&#8221;), the combination of (bookmark_id, tag_id, user_id) is unique, but there are multiple instances of (bookmark_id, tag_id). In a broad folksonomy you may want to maintain a separate table or index of (bookmark_id, tag_id) &#8212; that is, a basic inverted index table that consolidates all the users&#8217; tags into a single (tag, bookmark) row &#8212; to simplify searches that are user-agnostic.</p>
<p>You can find the distinction of of &#8220;narrow&#8221; vs. &#8220;broad&#8221; folksonomies:<br />
<a href="http://www.hyperorg.com/blogger/mtarchive/003840.html" rel="nofollow">http://www.hyperorg.com/blogger/mtarchive/003840.html</a></p>
	<p><cite>Comment by <a href='http://debris.com/journal' rel='external nofollow' class='url'>matt</a> &#8212; April 27, 2005 6:35 pm <a href="#comment-85">#comment-85</a></cite> </p>
	</li>

        	<li id="comment-86" class="zebra1">
	<p>Good comparison. It&#8217;s nice to see some information on how these &#8220;tagging&#8221; schemes are being put together. I actually use my own which I came up with prior to all the tagging articles I&#8217;ve been reading, similar to the Scuttle method.</p>
<p>As far as the Toxy solution goes, what is the need for an id field in the tagmap table? In order to prevent duplications of tag/bookmark pairs, you&#8217;d want a primary key of both the tag_id and the bookmark_id, thus eliminating the need for the id field.</p>
	<p><cite>Comment by <a href='http://patrickhaney.com' rel='external nofollow' class='url'>Patrick Haney</a> &#8212; April 27, 2005 9:35 pm <a href="#comment-86">#comment-86</a></cite> </p>
	</li>

        	<li id="comment-87" class="author">
	<p><a href="#comment-85" rel="nofollow">Matt</a>: Interesting! Good to have names for these things (broad/narrow folksonomy), I didn&#8217;t know that.<br />
I think I got your point: Have different index tables for different query types? That surely makes the insert/update/delete queries more expensive.. but at <a href="http://del.icio.us" rel="nofollow">del.icio.us</a>, this seems to be the case (slow inserts/fast queries). Even though I often wish that the inserts in del.icio.us would be faster..</p>
<p><a href="#comment-86" rel="nofollow">Patrick</a>: As <a href="#comment-78" rel="nofollow">Engelke</a> pointed it out, this column isn&#8217;t needed. I didn&#8217;t pay that much attention to details.. sorry :-)</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>phred</a> &#8212; April 28, 2005 6:44 am <a href="#comment-87">#comment-87</a></cite> </p>
	</li>

        	<li id="comment-89" class="zebra1">
	<p>the problem with &#8216;toxy&#8217; &#8212; or any &#8212; subselects (despite their 3nf goodness) is that they&#8217;re not optimized in mysql.  try explain select * in (select &#8230;)<br />
the solution is to hit the database a few times and perform the queries and array joining yourself in the app logic.<br />
shameless self-link explaining how to do related-tags with mysql and ruby/rails: <a href='http://habtm.com' rel="nofollow">habtm.com</a><br />
<ins datetime="2005-05-02T19:42:39-02:00">[Ed:] The article, courteany refers to: <a href="http://habtm.com/articles/2005/05/01/tagging-again-mysql-subselects-suck">Tagging again</a></ins></p>
	<p><cite>Comment by <a href='http://habtm.com' rel='external nofollow' class='url'>courteany</a> &#8212; May 1, 2005 9:59 am <a href="#comment-89">#comment-89</a></cite> </p>
	</li>

        	<li id="comment-91" class="zebra2">
	<p>Following up on <a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-85" rel="nofollow">Matt&#8217;s comment</a>, the decision to have a broad folksonomy (with user specific tags, eg, del.icio.us) or a narrow folksonomy (with only one set of tags per item, eg, flickr.com) would have a big impact on the schema. </p>
<p>del.icio.us, for example, also allows each user to add comments (under the &#8220;extended&#8221; field) for each bookmark/ tag item.  This approach suggests the three-table &#8220;Toxy&#8221; schema.</p>
<p>The tagmap table would also need user_id or username.  Then the table would have a composite primary key of user_id, tag_id, and bookmark_id. </p>
<p>tagmap<br />
 tagmap_id (optional)<br />
 user_id<br />
 tag_id<br />
 bookmark_id<br />
 user_comments_extended</p>
<p>Although a generic &#8216;id&#8217; is not necessary, tagmap could also use an auto increment tagmap_id in order to avoid using all three ids to reference a particular bookmark/ tag/ author&#8217;s item/ comments.</p>
	<p><cite>Comment by <a href='http://blogs.law.harvard.edu/brett/' rel='external nofollow' class='url'>brettstil</a> &#8212; May 2, 2005 7:00 am <a href="#comment-91">#comment-91</a></cite> </p>
	</li>

        	<li id="comment-92" class="zebra1">
	<p>I disagree. Both systems can be done in exactly the same way. I really can&#8217;t see why you need to store user information against tags. It&#8217;s all in how you collect and present the tag information, not how you store it. Using a tags, items, tags_to_items style schema works fine even with user specific tags.. that&#8217;s because there /is/ no such things as a user specific tag. It just &#8216;appears&#8217; as if there is, since if you want to show &#8220;all items with tag X by user Y&#8221;.. you just craft the query to only get those responses. If the user wants to change the tag name, you just add a new tag to the general set, and change the relationships over.</p>
	<p><cite>Comment by <a href='http://www.petercooper.co.uk/' rel='external nofollow' class='url'>Peter Cooper</a> &#8212; May 5, 2005 1:04 pm <a href="#comment-92">#comment-92</a></cite> </p>
	</li>

        	<li id="comment-93" class="zebra2">
	<p>Peter, you&#8217;re correct that &#8220;there /is/ no such things as a user specific tag&#8221;. By that I mean, there&#8217;s probably only one tag_id for the tag &#8220;CSS&#8221;, and only one tag_id for the tag &#8220;macintosh&#8221;, and only one tag_id for the tag &#8220;photoshop&#8221;, within the del.icio.us database. In other words, the tags themselves are not user-specific.</p>
<p>However, the association of tags to URLs is absolutely user-specific. del.icio.us allows two users to tag one URL with two different sets of tags. This implies that user information must be present in the tagmap table. In other words, the combination of (tag_id, url_id) is not unique; rather, only the 3-way combination of (tag_id, url_id, user_id) is unique.</p>
<p>There are alternative implementations that would keep user data out of the tagmap table, but the user-to-tag-to-URL 3-way association has to be made somewhere, or else there is no way to distinguish my tags for a given URL from your tags for that URL.</p>
	<p><cite>Comment by <a href='http://debris.com/journal' rel='external nofollow' class='url'>matt</a> &#8212; May 5, 2005 4:01 pm <a href="#comment-93">#comment-93</a></cite> </p>
	</li>

        	<li id="comment-97" class="zebra1">
	<p>Hi Phillip, </p>
<p>Thanks for the overview of potential tagging solutions. As the author of Freetag, I hope I can contribute a few notes. </p>
<p>Freetag uses a Toxy-like solution, but it&#8217;s actually more extensive than that. The &#8220;Bookmarks&#8221; sample table can be anything with Freetag. One of the planned features is to support different namespaces that you can use to hold references to completely different objects / users.</p>
<p>Also, Freetag does store a reference back to a user when the user tags an object. The tags themselves are stored once, but the tagging user is identified inside of the middle referential table.</p>
<p>It shouldn&#8217;t present any problems with systems that display non-user-related tags, as all of the API functions allow you to either specify a user ID to filter with, or leave that parameter as NULL to bring back a user-global set of tags on that object.</p>
<p>Personally, I don&#8217;t see anyone normal building complex intersections or unions with any sort of tag logic anytime soon. I&#8217;m planning a little writeup on my blog later about this topic, so check around in a few days for more of my opinions about why those aren&#8217;t that important.</p>
<p>Thanks for the mention!</p>
<p>-Gordon</p>
	<p><cite>Comment by <a href='http://getluky.net/freetag/' rel='external nofollow' class='url'>Gordon Luk</a> &#8212; May 10, 2005 6:00 pm <a href="#comment-97">#comment-97</a></cite> </p>
	</li>

        	<li id="comment-98" class="author">
	<p><a href="#comment-97">Gordon</a>: Interesting that nobody wants those complex intersections&#8230;<br />
Because I&#8217;d like to have them.. I&#8217;d like to browse delicious with more complex combination of tags. For instance to track new urls as rss feed or so.</p>
<p>I have a followup of <a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html#comment-85" rel="nofollow">Matts</a>  comment: Replicating data is the key for fast applications.. just look how <a href="http://www.niallkennedy.com/blog/archives/2004/10/flickr_architec.html">flickr has done it</a>:<br />
<blockquote>Normalized data is for sissies.</p></blockquote>
<p>I like that!</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>phred</a> &#8212; May 12, 2005 12:40 pm <a href="#comment-98">#comment-98</a></cite> </p>
	</li>

        	<li id="comment-357" class="zebra1">
	<p>Hello Folks,</p>
<p>I have been blogging about exactly these issues and from fundamental principles have derived a database schema that appears to encompass all these ideas in one place.  It uses lessons from data warehousing where massive datasets and complex queries are common.  I come from a relational database background (worked at Sybase and Ingres in the 90&#8217;s) and am pretty certain that multi-table joins will not scale to the data volumes that folksonomy apps will generate.  My blog, <a href="http://tagschema.com" rel="nofollow">tagschema</a>, contains both philosophical musings about tag based apps and hard core logical database design that addresses a lot of the issues that appear here.<br />
I am glad I stumbled upon this site via deli.icio.us of course, and am glad to see that other practitioners have also been thinking along similar lines.</p>
<p>Philip thanks very much for starting this thread, it is vital that such knowledge be shared and devloped in the community to be able to build next generation tagapps.</p>
<p>Looking forward to more &#8230;..</p>
	<p><cite>Comment by <a href='http://tagschema.com' rel='external nofollow' class='url'>Nitin Borwankar</a> &#8212; June 25, 2005 12:19 am <a href="#comment-357">#comment-357</a></cite> </p>
	</li>

        	<li id="comment-437" class="zebra2">
	<p>phred &#8211; </p>
<p>Freetag now does support tag combos, or intersections. Sorry if the post above came off as condescending. I think what I meant to say was that before intersections become useful, it&#8217;s more important to have a well tagged database. Delicious now has them, which is actually useful, because of the sheer size of the database. For smaller apps, it may not be as handy except for extreme power users who are using them to enforce ad-hoc namespaces. However, I do understand that there are people like yourself who want them, so i&#8217;m doing my best to accomodate that.</p>
<p>Thanks,</p>
<p>Gordon</p>
	<p><cite>Comment by <a href='http://getluky.net/freetag/' rel='external nofollow' class='url'>Gordon Luk</a> &#8212; June 28, 2005 4:57 pm <a href="#comment-437">#comment-437</a></cite> </p>
	</li>

        	<li id="comment-1179" class="zebra1">
	<p>They&#8217;re called &#8220;conjunction&#8221; and &#8220;disjunction&#8221; queries (and they are all &#8220;restriction&#8221; queries), not &#8220;union&#8221; and &#8220;intersection&#8221;. &#8220;union&#8221; and &#8220;intersection&#8221; come from set theory. A single table (or joined group of tables, or view, etc.) is a set, so any query with WHERE criteria against that set will form a subset &#8211; literally a restriction of the original set. </p>
<p>UNION is a standard SQL keyword that allows you to join together the results of *separate* queries, views, etc. It has nothing to do with AND criteria in the WHERE clause, just as the term &#8220;intersection&#8221; (also a SQL keyword, but not nearly as widely supported as UNION) has nothing to do with OR criteria. </p>
<p>Remember, within the context of a single query, AND and OR criteria in any combination always create a subset, not multiple sets. Only talk about UNION and INTERSECT when you are working with the results of multiple queries. It&#8217;ll be easy to know when to use the term UNION, because it will actually be part of your query! Not that it&#8217;s impossible to create a union without the UNION keyword, but usually UNION makes the most sense. INTERSECT, on the other hand, is not supported in many databases, but it&#8217;s still easy to identify whether you are working with one set or multiple sets.</p>
<p>Actually, your usage of these terms is interesting, as it indicates that you view a table as many possible sets derived from all possible queries. That&#8217;s a legitimate point of view, but relational theory is quite clear about the concept that a table is to be considered a set, and potential sets are just that: potential. Once you create one of those possible sets with, say, a query. Hey, now you&#8217;ve got another set and can deal with it accordingly &#8211; but not until it actually exists.</p>
<p>By the way, your &#8220;three-table-schema&#8221; is simply called a many-to-many schema: there is no other way to acheive a many-to-many relationship in an RDBMS. The &#8220;tagmap&#8221; is called a &#8220;link&#8221; table or, more formally, an association table (particularly if additional information is stored in each &#8220;link&#8221; record, like what user posted the tag, post time, etc.). You would usually name it &#8220;bookmark_tag&#8221; to clearly indicate that its only purpose is to join the bookmark and tag tables (and to leave room for other link table names like &#8220;photo_tag&#8221;, etc.).</p>
<p>OK, far too much preaching. Sorry.</p>
	<p><cite>Comment by Ryan &#8212; August 29, 2005 8:28 pm <a href="#comment-1179">#comment-1179</a></cite> </p>
	</li>

        	<li id="comment-1879" class="zebra2">
	<p>thank you very much guys, it helped a lot while looking for &#8220;related tags hell&#8221;</p>
<p>:)</p>
<p>our site will be online in a few days.</p>
	<p><cite>Comment by <a href='http://www.orange021.com' rel='external nofollow' class='url'>sathia</a> &#8212; December 6, 2005 4:28 pm <a href="#comment-1879">#comment-1879</a></cite> </p>
	</li>

        	<li id="comment-1889" class="zebra1">
	<p>[...] En el post se ponen a prueba los cuatro enfoques de modelado de sistemas de tagging que ya propuso en su anterior post &#8220;Tags: database schemas&#8220;. Los cuatro enfoques propuestos son: [...]</p>
	<p><cite>Pingback by <a href='http://www.mildiez.net/archivos/2005/12/08/como-modelar-un-sistema-de-tags/' rel='external nofollow' class='url'>mildiez.net &raquo; Archivo de bitcora &raquo; Cmo modelar un sistema de tags</a> &#8212; December 8, 2005 5:54 pm <a href="#comment-1889">#comment-1889</a></cite> </p>
	</li>

        	<li id="comment-2330" class="zebra2">
	<p>[...] Quando ho un po&#8217; di tempo libero, mi diletto a scrivere e provare alcune cose che riguardano il web, ultimamente ajax  In questi giorni sto buttando giù una semplice Image Gallery che avesse tra le feature un sistema di tagging per le immagini (assegnare ad ogni immagine alcune parole chiave). Per far ciò ho esaminato alcune soluzioni di Database Schema e ho deciso di implementare la &#8220;Toxi Solution&#8220;, con 3 tabelle separate: una per le foto, una per i tag e una che fa da collegamento a queste due tabelle. A questo punto le query per la ricerca delle foto venivano suggerite, resta da effettuare una query per avere tutti i tag con relativo conteggio, per avere una Tag Cloud. Leggendo questo articolo su html.it (con codice per ColdFusion) e quest&#8217;altro articolo di Augusto Murri (con codice per PHP), ho seguito le indicazioni per permettere la visualizzazione di diverse grandezze di carattere in base all&#8217;utilizzo del tag. Arrivando al punto, l&#8217;unico problema è che li non viene utilizzata la sopracitata &#8220;Toxi Solution&#8221;, quindi c&#8217;è bisogno di modificare la query. Ecco il codice relativo: PLAIN TEXT PHP: [...]</p>
	<p><cite>Pingback by <a href='http://www.napyfab.com/blog/48/programmare-una-tag-cloud-in-php-toxi-solution/' rel='external nofollow' class='url'>napyfab:blog &raquo; Programmare una Tag Cloud in PHP (Toxi-solution)</a> &#8212; March 7, 2006 12:20 am <a href="#comment-2330">#comment-2330</a></cite> </p>
	</li>

        	<li id="comment-2346" class="zebra1">
	<p>Why would you have the fields tagmap.id and tag.tag_id in the tables? I would think that in tagmap table the bookmark_id and the tag_id would serve as a primary key, and in the tag table the name of the tag would work just fine as a primary key?</p>
	<p><cite>Comment by <a href='http://www.bedre.no' rel='external nofollow' class='url'>Torkil</a> &#8212; March 9, 2006 10:26 am <a href="#comment-2346">#comment-2346</a></cite> </p>
	</li>

        	<li id="comment-2347" class="zebra2">
	<p>Torkil: tagmap.id is superflous, you are right (this has already been suggested in one of the numerous comments). I wouldn&#8217;t leave out the tag_id column. Call me old-fashioned but I don&#8217;t like string fields as foreign keys. Then, if you take the name of the tag as primary key then you don&#8217;t need that table, do you? Then you&#8217;d end up in the Scuttle solution.</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>Philipp Keller</a> &#8212; March 9, 2006 10:56 am <a href="#comment-2347">#comment-2347</a></cite> </p>
	</li>

        	<li id="comment-2397" class="zebra1">
	<p>[...] J&#8217;ai trouvé un article sur le blog de Philipp Keller qui parle du schéma de base de données utilisé par del.icio.us. Quelques notes : [...]</p>
	<p><cite>Pingback by <a href='http://chris.is-a-geek.net/wordpress/?p=25' rel='external nofollow' class='url'>chris.is-a-geek.net &raquo; Blog Archive &raquo; Schémas de bases de données pour la gestion de tags</a> &#8212; March 16, 2006 7:50 pm <a href="#comment-2397">#comment-2397</a></cite> </p>
	</li>

        	<li id="comment-2443" class="zebra2">
	<p>Hi,<br />
the source code and the relational schema of <a href="http://www.connotea.org" rel="nofollow">connotea</a> (a clone of del.icio.us for academics) is available at <a href="http://www.connotea.org/code" rel="nofollow">http://www.connotea.org/code</a>.</p>
<p>Pierre</p>
	<p><cite>Comment by <a href='http://plindenbaum.blogspot.com' rel='external nofollow' class='url'>Pierre</a> &#8212; March 22, 2006 9:49 pm <a href="#comment-2443">#comment-2443</a></cite> </p>
	</li>

        	<li id="comment-2448" class="zebra1">
	<p>Pierre: Thanks for the link!<br />
I quickly skimmed the database schema and they have separate tables for bookmarks, tags and users (as well as annotations, comments, etc.)<br />
Then there is a bookmark_user table and finally a user_bookmark_tag table that joins table `tag` with table `user_bookmark`. They use InnoDB and have really nice schema. Here&#8217;s the SQL of their user_bookmark_tag table:</p>
<pre>
DROP TABLE IF EXISTS `user_bookmark_tag`;
CREATE TABLE `user_bookmark_tag` (
  `user_bookmark_tag_id` int(7) unsigned NOT NULL auto_increment,
  `user_bookmark` int(7) unsigned NOT NULL default '0',
  `tag` int(7) unsigned NOT NULL default '0',
  `created` datetime NOT NULL default '0000-00-00 00:00:00',
  PRIMARY KEY  (`user_bookmark_tag_id`),
  UNIQUE KEY `user_bookmark_tag_idx` (`user_bookmark`,`tag`),
  KEY `user_bookmark_idx` (`user_bookmark`),
  KEY `tag_idx` (`tag`),
  CONSTRAINT `user_bookmark_tag_user_bookmark_fk` FOREIGN KEY (`user_bookmark`) REFERENCES `user_bookmark` (`user_bookmark_id`),
  CONSTRAINT `user_bookmark_tag_tag_fk` FOREIGN KEY (`tag`) REFERENCES `tag` (`tag_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
</pre>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>Philipp Keller</a> &#8212; March 23, 2006 8:45 am <a href="#comment-2448">#comment-2448</a></cite> </p>
	</li>

        	<li id="comment-2667" class="zebra2">
	<p>It&#8217;s true LIKE &#8220;%search%&#8221; in the MySQLicious solution will return websearch too, but if you change it to LIKE &#8220;% search %&#8221; if space separated or LIKE &#8220;%,search,%&#8221; if comma separated, you don&#8217;t have this problem.</p>
<p>Furthermore, the Toxi solution enable you to rename and delete tags easily (if you store tags separately for every user, else it may be a bit more complicated), while MySQLicious may have perfomance problems with this. Counting how many times a tag is used, tag suggestion (!), displaying tags for different users, popular tags&#8230; is easier too with the last solution. Scuttle is here always in between the other two solutions. It isn&#8217;t as slow as MySQLicious, but it&#8217;s not as fast as Toxi too.<br />
You could say MySQLicious operates from in the bookmarks: it does everything with regard to the bookmarks. Toxi sees the tags as separate entities: you can do things with your bookmarks, but you can also do operations with your tags (CRUD: not only Create, but also Retrieve, Update and Delete). Scuttle is somewhere in between. I think that solution is not really good, you can&#8217;t rename and delete tag like in Toxi, and you haven&#8217;t got the performance when displaying bookmarks only like in MySQLicious.<br />
Personally, I would use Toxi, the last one. Probably it will scale the best, especially when you want the user to be able to search by tag, edit and delete them, and if you want tag suggestion. Because tags are in a separated table, you can approach them as separated objects, independent of the bookmarks.</p>
<p>About del.icio.us: probably they use the last solution, although their rename and delete tag functions has been experimental for ages (maybe they use the third solution with tagmap mapping the bookmark_id and tag_id, and this needs a user_id too). However, the tag suggestion doesn&#8217;t load slow, so probably they use something like the third solution.</p>
	<p><cite>Comment by <a href='http://jw.clawz.com/blog' rel='external nofollow' class='url'>JW</a> &#8212; April 17, 2006 6:52 pm <a href="#comment-2667">#comment-2667</a></cite> </p>
	</li>

        	<li id="comment-5416" class="zebra1">
	<p>I just wanted to thank you for taking the time to pull all of this information together in one easy to use resource.  Based off of the work you&#8217;ve done to compare various systems I decided to use a modified Toxi system with a heirarcial structure built-in to organize photos and url&#8217;s.  I&#8217;m still tweaking some of the display pieces, but the database schema works great for my new oceancity.shownbyphotos.com site.  Cheers!</p>
	<p><cite>Comment by <a href='http://oceancity.shownbyphotos.com/' rel='external nofollow' class='url'>r2</a> &#8212; August 1, 2006 1:12 pm <a href="#comment-5416">#comment-5416</a></cite> </p>
	</li>

        	<li id="comment-5425" class="zebra2">
	<p>[...] &#8212;- UPDATE &#8212;- I ran across <a href="http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html" rel="nofollow">http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html</a> which has essentially solved my initial question with a question of ‘which method or DB schema should I use’. I’m leaning more toward the Toxi solution. Seeing those schemas in some relation to delicious is calming. I’ll se how it works out for me. [...]</p>
	<p><cite>Pingback by <a href='http://www.burnmytime.com/blog/2006/08/01/help-implementing-tagging-on-pd/' rel='external nofollow' class='url'>Josh Houghtelin &raquo; Blog Archive &raquo; Help implementing tagging on PD.</a> &#8212; August 1, 2006 11:29 pm <a href="#comment-5425">#comment-5425</a></cite> </p>
	</li>

        	<li id="comment-5434" class="zebra1">
	<p>[...] Update: OK&#8211;here&#8217;s a bit on all that. I&#8217;m still processing. Actually, some of this should be obvious from my own &#8220;Invitation Managment System.&#8221; Whatever. Moving on. [...]</p>
	<p><cite>Pingback by <a href='http://nillazilla.com/blog/?p=20' rel='external nofollow' class='url'>nillazilla.com &raquo; Blog Archive &raquo; Reaching 3NF with tags</a> &#8212; August 2, 2006 3:23 am <a href="#comment-5434">#comment-5434</a></cite> </p>
	</li>

        	<li id="comment-7277" class="zebra2">
	<p><strong>Database Schema for Tagging</strong></p>
<p>Every good database driven website needs a solid, scalable database backend. With bleeek.com I&#8217;ve decided to implement a tagging system for users to label their photos. Tagging is nothing new anymore and so the question is how are sites like del.icio&#8230;.</p>
	<p><cite>Trackback by <a href='http://dev.bleeek.com/database-schema-for-tagging.html' rel='external nofollow' class='url'>drupal</a> &#8212; September 9, 2006 11:43 am <a href="#comment-7277">#comment-7277</a></cite> </p>
	</li>

        	<li id="comment-11239" class="zebra1">
	<p>[...] There were a few approaches available on the net  but no one ever gave so many details about a possible implementation. [...]</p>
	<p><cite>Pingback by <a href='http://www.noosfactory.com/blog/?p=53' rel='external nofollow' class='url'>Any folksonomies around? at NoosFactory</a> &#8212; October 9, 2006 4:30 pm <a href="#comment-11239">#comment-11239</a></cite> </p>
	</li>

        	<li id="comment-11939" class="zebra2">
	<p>[...] I decided to add tagging to a web app that I&#8217;m working on in my spare time and wondered after the best way to do it in the database. I was curious if current services that use tags (flickr, del.icio.us, etc) did it using a normalized or denormalized schema. The first article I came across was &#8220;Tags: Database schemas&#8221; by Philipp Keller which gave three example schemas and expounded on thier different pros and cons. I quickly realized as I was reading that the answer depends greatly on the question (as is usually the case) and how you want to implement tagging is the first thing to figure out. Putting the how aside I continued reading the article and the great comments. One of the commenter’s was Nitin Borwankar who mentioned his blog focused solely on tagging schemas for the new breed of &#8220;folksonomy&#8221; based tools. I immediately read the archive from start to finish and added his RSS feed to my GReader. The main thing that I got out of his blog was that if your going to do tagging you might as well do it right and treat tags as full-fledged schema elements. [...]</p>
	<p><cite>Pingback by <a href='http://devsushi.com/2006/10/14/thinking-about-database-schemas/' rel='external nofollow' class='url'>dev|sushi &raquo; Thinking about database schemas</a> &#8212; October 14, 2006 6:52 pm <a href="#comment-11939">#comment-11939</a></cite> </p>
	</li>

        	<li id="comment-12083" class="zebra1">
	<p>[...] The best resource that I&#39;ve found on the subject is this plog post on the different database schemas .&nbsp; I&#39;m also quite impressed with the author&#39;s breakdown of performance times for tagging datastructures as the number of tags increased. For most of the applications that I build, there would be a minimal number of tags as they will be managed from one central administration (unlike Flickr or Delicious where users can define their own tags). [...]</p>
	<p><cite>Pingback by <a href='http://christen.dybenko.net/index.php/2006/10/15/tagging-where-the-frig-do-i-start/' rel='external nofollow' class='url'>That&#8217;s What She Said</a> &#8212; October 16, 2006 1:44 am <a href="#comment-12083">#comment-12083</a></cite> </p>
	</li>

        	<li id="comment-12143" class="zebra2">
	<p>Hi guys&#8230; I was really interested by the topics&#8230;<br />
but also a bit dispointed because I have a TOXI based structure but i do the queries a COMPLETELY DIFFERENT WAY&#8230;<br />
Maybe i&#8217;m totally wrong about performance or maybe right?<br />
I don&#8217;t know (i&#8217;m actually dealing with a very little database and just finished to write the piece of code for building the query which made be a little lazy&#8230;)!!!<br />
The only thing i know is that it&#8217;s REALLY SIMPLE to generate a really complex query like (del.icio.us|delicious)+(semweb|semantic_web)-search and that was my only goal!</p>
<p>I WILL GREATLY APPRECIATE ANY COMMENT ABOUT THE PERFORMANCE OF THE QUERIES BELOW!</p>
<p>PS : It&#8217;s possible that i missed something in the queries because i rewrote them from memory but if I did, you should be able to correct them, if not, you can write me at <a href="mailto:dominique.hamet@hotmail.com">dominique.hamet@hotmail.com</a></p>
<p>Intersection (AND)<br />
Query for “bookmark+webservice+semweb”<br />
assuming ids are 1,2,3<br />
SELECT b.*<br />
FROM tagmap bt0,tagmap bt1,tagmap bt2, bookmark b, tag t<br />
WHERE (b.id = bt0.bookmark_id)<br />
AND (bt0.tag_id = t.tag_id)<br />
AND (bt0.tag_id=bt1.tag_id) AND (bt1.tag_id=bt2.tag_id)<br />
AND ((bt0.tag_id=1) AND (bt1.tag_id=2) AND (bt2.tag_id=3))</p>
<p>Union (OR)<br />
Query for “bookmark|webservice|semweb”<br />
assuming ids are 1,2,3<br />
SELECT b.*<br />
FROM tagmap bt0,tagmap bt1,tagmap bt2, bookmark b, tag t<br />
WHERE (b.id = bt0.bookmark_id)<br />
AND (bt0.tag_id = t.tag_id)<br />
AND (bt0.tag_id=bt1.tag_id) AND (bt1.tag_id=bt2.tag_id)<br />
AND ((bt0.tag_id=1) OR (bt1.tag_id=2) OR (bt2.tag_id=3))</p>
<p>Minus (Exclusion)<br />
Query for “bookmark+webservice-semweb”, that is: bookmark AND webservice AND NOT semweb.<br />
assuming ids are 1,2,3<br />
SELECT b.*<br />
FROM tagmap bt0,tagmap bt1,tagmap bt2, bookmark b, tag t<br />
WHERE (b.id = bt0.bookmark_id)<br />
AND (bt0.tag_id = t.tag_id)<br />
AND (bt0.tag_id=bt1.tag_id) AND (bt1.tag_id=bt2.tag_id)<br />
AND ((bt0.tag_id=1) AND (bt1.tag_id=2) AND (bt3.tag_id3))</p>
	<p><cite>Comment by HAMET Dominique &#8212; October 16, 2006 10:11 pm <a href="#comment-12143">#comment-12143</a></cite> </p>
	</li>

        	<li id="comment-12837" class="zebra1">
	<p>If you want to show the tags as well in on field, you can try this one!</p>
<p>SELECT b.*,GROUP_CONCAT(t.NAME) AS tags FROM tagmap bt, bookmark b, tag t WHERE bt.tag_id = t.tag_id AND (t.name IN (&#8216;bookmark&#8217;, &#8216;webservice&#8217;, &#8217;semweb&#8217;)) AND b.id = bt.bookmark_id GROUP BY b.id HAVING COUNT( b.id )=3</p>
<p>I used group_concat</p>
	<p><cite>Comment by Matthijs &#8212; October 24, 2006 2:06 pm <a href="#comment-12837">#comment-12837</a></cite> </p>
	</li>

        	<li id="comment-13357" class="zebra2">
	<p>One problem I can&#8217;t get around when I am using the toxi structure is to display everything except a certain tag. For example if I want to find NOT &#8220;cats&#8221;. The problem is to get it working when there are entries that doesn&#8217;t have any tags at all, since the search will exclude them when requiring a link to the tag bookmark table (since the link doesn&#8217;t exist). Has anyone else had this problem and found a solution?</p>
	<p><cite>Comment by Jim &#8212; October 30, 2006 11:10 am <a href="#comment-13357">#comment-13357</a></cite> </p>
	</li>

        	<li id="comment-13652" class="zebra1">
	<p>In the toxi solution, why doesn&#8217;t the &#8216;tagmap&#8217; table use a composite primary key?</p>
<p>I believe this would provide the key uniqueness required while preventing an additional index being internally created and maintained for the &#8216;id&#8217; column.</p>
	<p><cite>Comment by <a href='http://www.nfwebsolutions.com/' rel='external nofollow' class='url'>Zeeshan</a> &#8212; November 2, 2006 1:03 pm <a href="#comment-13652">#comment-13652</a></cite> </p>
	</li>

        	<li id="comment-14213" class="zebra2">
	<p>I previously looked into the methods of creating a tag database, there was very little material to cover it.</p>
<p>Well done on creating this article.</p>
	<p><cite>Comment by <a href='http://www.hm2k.org/' rel='external nofollow' class='url'>HM2K</a> &#8212; November 8, 2006 4:16 pm <a href="#comment-14213">#comment-14213</a></cite> </p>
	</li>

        	<li id="comment-43754" class="zebra1">
	<p>Using the toxi solution, if I wanted to query for “bookmark+webservice|semweb” how would I accomplish it?</p>
<p>I am no SQL expert but it seems like you must us either AND or OR without mixing them.</p>
	<p><cite>Comment by <a href='http://www.dustinnoe.com' rel='external nofollow' class='url'>Dustin</a> &#8212; March 23, 2007 6:35 am <a href="#comment-43754">#comment-43754</a></cite> </p>
	</li>

        	<li id="comment-43940" class="zebra2">
	<p>Solved my own problem.  I justed created two separate statements, one for AND and one for OR, and UNIONed them together.  By the way, great article!</p>
	<p><cite>Comment by <a href='http://www.dustinnoe.com' rel='external nofollow' class='url'>Dustin</a> &#8212; March 24, 2007 2:54 am <a href="#comment-43940">#comment-43940</a></cite> </p>
	</li>

        	<li id="comment-57952" class="zebra1">
	<p>Awesome article, been looking for something like this.  I had sketched my tag solution like Toxi&#8217;s but wanted to see what others use&#8230; your breakdown is great!</p>
	<p><cite>Comment by phugit &#8212; May 29, 2007 11:41 pm <a href="#comment-57952">#comment-57952</a></cite> </p>
	</li>

        	<li id="comment-63209" class="zebra2">
	<p>Hi, nice post!</p>
<p>Did you find out which system is used by the del.icio.us? I mean &#8211; do they use RDBMS or not?</p>
	<p><cite>Comment by <a href='http://koudesnik.livejournal.com/' rel='external nofollow' class='url'>Koudesnik</a> &#8212; June 13, 2007 10:07 pm <a href="#comment-63209">#comment-63209</a></cite> </p>
	</li>

        	<li id="comment-63283" class="zebra1">
	<p>Koudesnik: See <a href="http://www.pui.ch/phred/archives/2005/06/tagsystems-performance-tests.html" rel="nofollow">Using a non-RDBMS system</a>: I guess del.icio.us has still some parts stored in RDBMS but others not.<br />
What astonishes me is that their <a href="http://del.icio.us/search/" rel="nofollow">search</a> is still very slow. That looks for me that their not yet using lucene indexes for all parts.</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>Philipp Keller</a> &#8212; June 14, 2007 7:14 am <a href="#comment-63283">#comment-63283</a></cite> </p>
	</li>

        	<li id="comment-67308" class="zebra2">
	<p>Great article. Perfect for me. Sure I am building something 2 years after you wrote the article &#8211; but still perfect :-)</p>
<p>Just a comment on Tag Orphans &#8211; this is only a problem with some RDBMSs &#8211; if you use proper forign key solutions they will automatically get removed &#8211; which is clearly desirable. I won&#8217;t get into which SQL service here as I think they all have their advantages and disadvantages and I don&#8217;t want to start a debate on that. But I will post my SCHEMA once it is done &#8211; and if lucky, work will allow me to open source the library.</p>
<p>Thanks</p>
<p>Scott</p>
	<p><cite>Comment by Scott Penrose &#8212; June 27, 2007 10:48 pm <a href="#comment-67308">#comment-67308</a></cite> </p>
	</li>

        	<li id="comment-69989" class="zebra1">
	<p>hi,</p>
<p>What do u think about organizing table structure in star-schema?</p>
<p>i would consider building a star-schema and creating a cube of that however a cube that is organized for query speed&#8230;size would be&#8230;.well lets just say&#8230;BIG :) :) :)</p>
<p>regards,<br />
dado</p>
	<p><cite>Comment by dado &#8212; July 6, 2007 5:08 pm <a href="#comment-69989">#comment-69989</a></cite> </p>
	</li>

        	<li id="comment-73490" class="zebra2">
	<p>The best solution in my opinion is to Toxi / Wordpress solution on a PostGreSQL database. That way, you have a fairly normalized structure that is easily maintainable and clear to view. To solve the ophaned-element problem, you have triggers / stored procedures at your fingertips. I have always preferred PostGreSQL over MySQL because working with MySQL always seemed a bit like working with half of a product really. The support for it may be embedded in every weblanguage available, but compiling PHP from source with &#8211;with-pgsql=&#8221;" (recommended) or editing your extensions.ini isn&#8217;t really a reason to stick with MySQL. PostGreSQL is superior to MySQL in my opinion because it supports ALL of the features expected from a production-grade database system, whereas MySQL only supports those that are commonly used by amateur webapps. Proof: <a href="http://monstera.man.poznan.pl/wiki/index.php/Mysql_vs_postgres" rel="nofollow">http://monstera.man.poznan.pl/wiki/index.php/Mysql_vs_postgres</a>.</p>
<p>Good day :)</p>
	<p><cite>Comment by <a href='http://na' rel='external nofollow' class='url'>James</a> &#8212; July 21, 2007 1:59 am <a href="#comment-73490">#comment-73490</a></cite> </p>
	</li>

        	<li id="comment-73761" class="zebra1">
	<p>Dado: I&#8217;m not into star schema/fact tables, but <a href="http://tagschema.com/blogs/tagschema/2005/06/slicing-and-dicing-data-20-part-2.html" rel="nofollow">Nitin</a> wrote about this.</p>
	<p><cite>Comment by <a href='http://www.pui.ch/phred/' rel='external nofollow' class='url'>Philipp Keller</a> &#8212; July 22, 2007 3:49 pm <a href="#comment-73761">#comment-73761</a></cite> </p>
	</li>

        	<li id="comment-74697" class="zebra2">
	<p>The main problem of the MySQLicious is not the using of Like, this is not the performance killer because it is quite fast.<br />
The problem is using the %.<br />
if you put the % at the end mysql can use the index to search for the right data, as in a telephonebook you know a name begins with &#8220;Mill&#8221; so you can use the index and jump &#8220;directly&#8221; to the namens beginning with &#8220;Mill&#8221;.<br />
But know you want to search all persons whos name end with &#8220;ller&#8221; (we are searching for Miller). Try to use the index, hmm, you can&#8217;t? correct!<br />
And thats the Problem of using % at the beginning of an String in a Like-Query, it cannot use the index and so it will be veeeery slow, if the data is increasing.</p>
	<p><cite>Comment by Tobias Petry &#8212; July 27, 2007 3:13 pm <a href="#comment-74697">#comment-74697</a></cite> </p>
	</li>

        	<li id="comment-81676" class="zebra1">
	<p>Thank you for the post. I was looking for the information about database schemas for tagging. The post and discussion cover everything I need!</p>
<p>By the way I think you might be interested in the approach described here (it is too serious for my needs but may be a good solution for big web sites): <a href="http://scalablecorner.blogspot.com/2007/06/implementing-tag-cloud-nasty-way-part-2.html" rel="nofollow">http://scalablecorner.blogspot.com/2007/06/implementing-tag-cloud-nasty-way-part-2.html</a></p>
	<p><cite>Comment by <a href='http://N/A' rel='external nofollow' class='url'>MikeTM</a> &#8212; September 2, 2007 5:42 pm <a href="#comment-81676">#comment-81676</a></cite> </p>
	</li>

        	<li id="comment-82182" class="zebra2">
	<p>Really useful post and comments, read all of them thoroughly and it&#8217;s helped me get my head around some of the key complexities in building a tag-based architecture.</p>
<p>Good work.</p>
	<p><cite>Comment by <a href='http://www.globaloptima.co.uk' rel='external nofollow' class='url'>Toby Skinner</a> &#8212; September 5, 2007 2:09 am <a href="#comment-82182">#comment-82182</a></cite> </p>
	</li>

        	<li id="comment-85243" class="zebra1">
	<p>Excellent Article, Thanks a lot!</p>
	<p><cite>Comment by Daniel &#8212; September 17, 2007 7:53 pm <a href="#comment-85243">#comment-85243</a></cite> </p>
	</li>

        	<li id="comment-101283" class="zebra2">
	<p>Some people have suggested that the Toxi solution could be used with duplicate tags in the tag table in order to simplify inserts and deletes, wouldnt this mean it was effectively a scuttle solution?</p>
	<p><cite>Comment by <a href='http://www.shiningthrough.co.uk' rel='external nofollow' class='url'>Gordo</a> &#8212; November 30, 2007 9:53 am <a href="#comment-101283">#comment-101283</a></cite> </p>
	</li>

        	<li id="comment-107520" class="zebra1">
	<p>Has anyone found a quick way of getting a list of related tags for a set of tags using the “Toxi” schema.</p>
<p>For example, say I wanted to find all the tags that appeared in bookmarks which were tagged with &#8216;webservice&#8217; and ‘bookmark’. Ideally it would be good to get the related tags and the count of how many bookmarks have that related tag. Does anyone have any ideas on an efficient way of getting this related tag data?</p>
	<p><cite>Comment by noodles &#8212; January 27, 2008 8:00 pm <a href="#comment-107520">#comment-107520</a></cite> </p>
	</li>

        	<li id="comment-129546" class="zebra2">
	<p>Thank you, this article helps me a lot!</p>
	<p><cite>Comment by <a href='http://mefi.be/' rel='external nofollow' class='url'>Mefi</a> &#8212; June 4, 2008 4:29 pm <a href="#comment-129546">#comment-129546</a></cite> </p>
	</li>

        	<li id="comment-130014" class="zebra1">
	<p>Thank you for this article ! very useful</p>
	<p><cite>Comment by Mike &#8212; November 4, 2008 10:44 am <a href="#comment-130014">#comment-130014</a></cite> </p>
	</li>

        	<li id="comment-130016" class="zebra2">
	<p>Thank you for your time! Your article helped me to quickly create what I wanted. </p>
<p>All the best!</p>
	<p><cite>Comment by Joao &#8212; November 5, 2008 6:12 pm <a href="#comment-130016">#comment-130016</a></cite> </p>
	</li>

        	<li id="comment-130067" class="zebra1">
	<p>thanks, this article help me to clarify the things.</p>
	<p><cite>Comment by Marco &#8212; January 10, 2009 3:23 am <a href="#comment-130067">#comment-130067</a></cite> </p>
	</li>

        	<li id="comment-130322" class="zebra2">
	<p>how to store facets or faceted data in a database  with example can any body try and provide?</p>
	<p><cite>Comment by sai &#8212; March 5, 2009 12:18 pm <a href="#comment-130322">#comment-130322</a></cite> </p>
	</li>

        	<li id="comment-130336" class="zebra1">
	<p>Thanks for your very interesting and useful blog posts, Philipp.  This one in particular was of great help to me in figuring out how to make a tag system, which I&#8217;ve been using in multiple projects.  My tag system was based on the &#8220;Toxi&#8221; solution.</p>
<p>I recently released my own free, open source, public domain web links organizer program &#8211; Astroblahhh Links Organizer, a component of my incomplete software package Astroblahhh Desktop:</p>
<p><a href="http://astroblahhh.com/software/abdesktop" rel="nofollow">http://astroblahhh.com/software/abdesktop</a></p>
<p>I would welcome any feedback if you&#8217;re ever in the mood to try it out.</p>
<p>Quote by sai:<br />
&#8220;how to store facets or faceted data in a database with example can any body try and provide?&#8221;</p>
<p>I&#8217;m not sure exactly what faceted data is, but, judging by the Wikipedia article on faceted search, the concept kind of reminds me of Astroblahhh Desktop a bit, because of its filtering capabilities.  Maybe my program will be of interest to you.</p>
	<p><cite>Comment by <a href='http://astroblahhh.com/' rel='external nofollow' class='url'>Apollia</a> &#8212; March 7, 2009 12:41 am <a href="#comment-130336">#comment-130336</a></cite> </p>
	</li>

        	<li id="comment-130682" class="zebra2">
	<p>here is another idea.</p>
<p>one table, 2 columns</p>
<p>Then make a 2 column primary key (to disallow duplicates)</p>
<p>so&#8230;. select * from tag_table</p>
<p>URL | TAG<br />
<a href="http://www.wikipedia.org" rel="nofollow">http://www.wikipedia.org</a> | encyclopedia<br />
<a href="http://www.wikipedia.org" rel="nofollow">http://www.wikipedia.org</a> | reference<br />
<a href="http://www.wikipedia.org" rel="nofollow">http://www.wikipedia.org</a> | awesome</p>
<p>but how do I right the queries (intersection, etc)</p>
<p>thanks</p>
	<p><cite>Comment by syssyphus &#8212; May 18, 2009 4:13 pm <a href="#comment-130682">#comment-130682</a></cite> </p>
	</li>

        	<li id="comment-130767" class="zebra1">
	<p>Thank you very much, your article helped me a lot!</p>
	<p><cite>Comment by <a href='http://blog.huachen.me/' rel='external nofollow' class='url'>Hua Chen</a> &#8212; August 23, 2009 12:55 pm <a href="#comment-130767">#comment-130767</a></cite> </p>
	</li>

        	<li id="comment-130774" class="zebra2">
	<p>In the &#8220;toxi&#8221; solution, why is there an ID column on the &#8220;tagmap&#8221; table?  I don&#8217;t really see why that&#8217;s needed &#8211; or am I missing something?</p>
	<p><cite>Comment by <a href='http://www.nickgilbert.com' rel='external nofollow' class='url'>Nick Gilbert</a> &#8212; September 25, 2009 10:52 am <a href="#comment-130774">#comment-130774</a></cite> </p>
	</li>

        	<li id="comment-130775" class="zebra1">
	<p>You have help me build this site! <a href="http://www.TagThis.com" rel="nofollow">http://www.TagThis.com</a> thanks for the article! TagThis is a tag based search and suggestion engine that gives you tailor made results. it is still in its infancy. would greatly appreciate any feedback if you have time to check it out! cheers</p>
	<p><cite>Comment by <a href='http://tagthis.com' rel='external nofollow' class='url'>Marwan</a> &#8212; September 27, 2009 6:13 pm <a href="#comment-130775">#comment-130775</a></cite> </p>
	</li>

        	<li id="comment-130776" class="zebra2">
	<p>I was checking Google to see if there were any better solutions than an intersection table (Toxi), and found this. Good article, if not precisely what I was looking for.</p>
<p>One thing I did notice that you might care about is your disadvantage for Toxi&#8217;s schema;<br />
&#8220;When altering or deleting bookmarks you can end up with tag-orphans.&#8221;<br />
This isn&#8217;t the case if you use foreign keys (which Phillip Keller implements above), and if you add ON DELETE CASCADE to your reference clause any deletion of tags or items will also delete references to it in the intersection table- for better or worse.</p>
	<p><cite>Comment by Tozetre &#8212; September 30, 2009 6:49 pm <a href="#comment-130776">#comment-130776</a></cite> </p>
	</li>

        	<li id="comment-130778" class="zebra1">
	<p>this is very helpful &#8211; concise and well written.</p>
<p>THANKS!</p>
	<p><cite>Comment by turd &#8212; October 8, 2009 12:32 am <a href="#comment-130778">#comment-130778</a></cite> </p>
	</li>

        	<li id="comment-133603" class="zebra2">
	<p>Some good discussion and sharing of ideas in these comments.</p>
<p>I never even considered anything other than a relational 3 table schema. The system will be 99% selects so I suppose that&#8217;s best anyway:<br />
I&#8217;m making an e-commerce site.. Tags would only be added when new products were added (no user contributions).</p>
<p>I&#8217;m considering using tags rather than categories because the categories aren&#8217;t forming a nice hierarchy.<br />
Now I&#8217;m going to look into hierarchical tags systems.</p>
	<p><cite>Comment by <a href='http://www.sleath.co.uk' rel='external nofollow' class='url'>Hamish</a> &#8212; March 18, 2010 1:43 am <a href="#comment-133603">#comment-133603</a></cite> </p>
	</li>

        	<li id="comment-133604" class="zebra1">
	<p>Just been reading this good introduction to faceted classification:</p>
<p><a href="http://www.miskatonic.org/library/facet-web-howto.html" rel="nofollow">http://www.miskatonic.org/library/facet-web-howto.html</a></p>
<p>I hope someone else finds it useful.</p>
	<p><cite>Comment by <a href='http://www.sleath.co.uk' rel='external nofollow' class='url'>Hamish</a> &#8212; March 18, 2010 2:25 am <a href="#comment-133604">#comment-133604</a></cite> </p>
	</li>

        	<li id="comment-133608" class="zebra2">
	<p>Here&#8217;s how one might do this with Postgres:<br />
The REFERENCES on TMAP address the &#8220;orphans&#8221; issues when deleting records. </p>
<p>Big Upz to the MySQL wiki for the tips &#8211; ironic huh?<br />
<a href="http://forge.mysql.com/wiki/TagSchema#Toxi" rel="nofollow">http://forge.mysql.com/wiki/TagSchema#Toxi</a></p>
<p>CREATE TABLE links (<br />
    l_id SERIAL,<br />
    title varchar(55),<br />
    url varchar(255),<br />
    description varchar(300),<br />
    CONSTRAINT &#8220;links_pkey&#8221; PRIMARY KEY(&#8220;l_id&#8221;)<br />
);</p>
<p>CREATE TABLE tmap (<br />
    l_id integer REFERENCES links ON DELETE CASCADE,<br />
    t_id integer REFERENCES tags,<br />
    PRIMARY KEY (l_id, t_id)<br />
);</p>
<p>CREATE INDEX tag_id_idx ON tmap (t_id);</p>
<p>CREATE TABLE tags (<br />
    t_id SERIAL,<br />
    tag varchar(30) UNIQUE,<br />
    CONSTRAINT &#8220;tags_pkey&#8221; PRIMARY KEY(&#8220;t_id&#8221;)<br />
);</p>
<p>/////////////////////////////////</p>
<p>// grab data for a TAG cloud<br />
SELECT tag, COUNT(*) as count<br />
FROM tmap i2t<br />
INNER JOIN tags t<br />
ON i2t.t_id = t.t_id<br />
GROUP BY tag;</p>
<p>// grab data for links tagged with any of the 3 tags<br />
SELECT tmap.l_id<br />
FROM tmap<br />
INNER JOIN tags t<br />
ON tmap.t_id = t.t_id<br />
WHERE t.tag IN (&#8216;transcripts&#8217;,'registration&#8217;,'courses&#8217;)<br />
GROUP BY tmap.l_id;</p>
<p>// grab data for links tagged with all three tags being searched for<br />
SELECT i2t3.l_id<br />
FROM tags t1 CROSS JOIN tags t2 CROSS JOIN tags t3<br />
INNER JOIN tmap i2t1<br />
ON t1.t_id = i2t1.t_id<br />
INNER JOIN tmap i2t2<br />
ON i2t1.l_id = i2t2.l_id AND i2t2.t_id = t2.t_id<br />
INNER JOIN tmap i2t3<br />
ON i2t2.l_id = i2t3.l_id AND i2t3.t_id = t3.t_id<br />
WHERE t1.tag = &#8216;transcripts&#8217;<br />
AND t2.tag = &#8216;registration&#8217;<br />
AND t3.tag = &#8216;courses&#8217;;</p>
	<p><cite>Comment by KodeZilla &#8212; March 26, 2010 8:13 pm <a href="#comment-133608">#comment-133608</a></cite> </p>
	</li>

        	<li id="comment-133627" class="zebra1">
	<p>This is by far the best article on the world wide web that not only illustrates in clear concise language how to implement tags three different ways but also gives real world easy to follow examples and illustrations. My hat&#8217;s off to you sir. You deserve all the accolades endowed to you by your readers.</p>
	<p><cite>Comment by Jules Manson &#8212; May 21, 2010 8:01 am <a href="#comment-133627">#comment-133627</a></cite> </p>
	</li>

        	<li id="comment-133638" class="zebra2">
	<p>Thanks a ton, searching for this..</p>
	<p><cite>Comment by Sahan &#8212; June 30, 2010 10:40 am <a href="#comment-133638">#comment-133638</a></cite> </p>
	</li>

        	<li id="comment-133657" class="zebra1">
	<p>Very Nice post, quiet informative.<br />
Database designing problems being the buzzwords these days, one of the most common designing mistakes is the “Poor Planning / Architecture” of the database or mart. Follow the link to know more…<br />
<a href="http://www.sqllion.com/2010/08/database-design-and-modeling-i/" rel="nofollow">http://www.sqllion.com/2010/08/database-design-and-modeling-i/</a></p>
	<p><cite>Comment by <a href='http://www.sqllion.com' rel='external nofollow' class='url'>SQL Lion</a> &#8212; August 3, 2010 7:36 am <a href="#comment-133657">#comment-133657</a></cite> </p>
	</li>

        	<li id="comment-133658" class="zebra2">
	<p>What if The primary index on the Tags table was the tag itself? So it would look like this</p>
<p>Tags<br />
&#8212;-<br />
Tag<br />
PostID</p>
<p>Posts<br />
&#8212;-<br />
PostID<br />
Post</p>
<p>QUERY<br />
&#8212;&#8211;<br />
SELECT * FROM Posts WHERE PostID IN (SELECT PostID FROM Tags WHERE Tag = &#8216;$tag1&#8242; OR Tag = &#8216;$tag2&#8242;)</p>
	<p><cite>Comment by <a href='http://crazyhorsecoding.com' rel='external nofollow' class='url'>Sean Macdonald</a> &#8212; August 6, 2010 11:34 am <a href="#comment-133658">#comment-133658</a></cite> </p>
	</li>


</ol>


<p><a href='http://www.pui.ch/phred/archives/2005/04/tags-database-schemas.html/feed'><abbr title="Really Simple Syndication">RSS</abbr> feed for comments on this post.</a> 
</p>

<h2 id="postcomment">Leave a comment</h2>


<form action="http://www.pui.ch/phred/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1" />
<label for="author"><small>Name (required)</small></label></p>

<p><input type="text" name="email" id="email" value="" size="22" tabindex="2" />
<label for="email"><small>Mail (will not be published) (required)</small></label></p>

<p><input type="text" name="url" id="url" value="" size="22" tabindex="3" />
<label for="url"><small>Website</small></label></p>


<!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->

<p><textarea name="comment" id="comment" cols="100%" rows="10" tabindex="4"></textarea></p>

<p><input name="submit" type="submit" id="submit" tabindex="5" value="Submit Comment" />
<input type="hidden" name="comment_post_ID" value="29" />
</p>
<input type="hidden" id="sk2_my_js_check1" name="sk2_my_js_check1" value="ggehd5bo30" />
<input type="hidden" id="sk2_my_js_check2" name="sk2_my_js_check2" value="49adfaf4bbb148d926dce3c30d4f2adb" />
<script type="text/javascript">
<!--
	document.write('<input type="hidden" id="sk2_my_js_payload" name="sk2_my_js_payload" value="');
	document.write(Math.round ( Math.abs(Math.round ( Math.abs(Math.max(Math.max((((Math.round ( Math.abs(1 / 30)) + 22) + 19) + 30), 7), 7) % 42)))));
	document.write('" />');
-->
</script>

</form>


	
	<!-- begin footer -->
<div class="clear"></div>
<div class="licenced">
  This page and it's content is <a href="http://creativecommons.org/licenses/by-nc/1.0/">licenced under creative commons</a>
</div>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-53694-3";
urchinTracker();
</script>
</body>
</html>
